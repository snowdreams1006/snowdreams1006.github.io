# rpa 流程化机器人系列之从 0 到 1 开发自动回复公众号留言机器人

![微信公众号「雪之梦技术驿站」](/assets/picgo/6f3b53a1d54f77563e71b92645f520a7.gif)

> **致读者**: 点击上方 “雪之梦技术驿站” → 点击右上角“ ... ”→ 点选“设为星标 ★ ” 加上星标，就不会找不到我啦！

## 前言

众所周知,微信订阅号是支持开发接口的方式,可以实现自定义菜单和自动回复等基础功能.

但是,微信文章留言是无法自动回复的,因此才诞生了这篇文章,主要介绍了如何从 0 到 1 开发公众号留言自动回复机器人.

**流程大纲**

![](/assets/picgo/12b869ddd29c2da0451eac60058bc2d5.png)

**运行日志**

![](/assets/picgo/23cfb1036d0ac8292080ba50e0871ebf.png)

**消息推送**

![](/assets/picgo/66974c110160fa89887bb729a8979176.png)

**实际效果**

![](/assets/picgo/12000595e74d5e07323869336ba55c89.png)

## 思路

想要自动回复公众号留言,得知道留言在什么地方,目前只接触过两种方式,一种是公众号后台,另一种是订阅号助手 app.

了解过爬虫的同学都知道,网页版爬虫难度较低容易上手,所以采用浏览器爬取的方式模拟人工自动回复留言,这应该是可行的思路.

**内容与互动 / 留言**

手动登录微信后台(需要扫码登录)后定位到留言板块,可发现文章列表是下拉分页的形式,正常来说需要循环遍历,也可以只处理第一条留言.

![](/assets/picgo/5ce10f40fccc47a164e462acbd5a2dcb.png)

**回复**

使用鼠标轻轻划过留言点击可展开回复评论框,输入评论即可完成,为了防止重复回复,可用隔壁的是否点赞表示是否已回复.

![](/assets/picgo/4924b93f51b98ba321ec5d615fa5465c.png)

**盖楼回复**

针对一条评论,任何人都可以回复,有所取舍,不对其余评论继续回复.

![](/assets/picgo/f2fc788f35407b5482748f78f837ce94.png)

因此,思路很清晰,先人工登录微信公众号后台再上自动化流程: 定位到留言板块,按照默认的留言时间顺序针对第一篇留言文章,循环回复全部没有点赞过的评论.

**ai 自动回复**

可以设置为统一的回复话术也可以利用 ai 自动回复该评论,效果如下:

![](/assets/picgo/0554b1eecf3d44a2e4f71ca510dc1c42.png)

顺便说一下,雪之梦技术驿站公众号已接入 ai 自动回复,也可以@ai 输入你的问题体验一下哟~

![](/assets/picgo/c737ccfe00a360f6efe47fbca1861082.png)

## 实战

**记录工作流**

点击创建工作流,下面第二个可以记录工作流,这一步会按照当前正常操作步骤如实记录全部步骤,简单好用.

![](/assets/picgo/009671711047f94155080e7b047abe45.png)

为当前工作流起一个名称和描述,方便下回能找到该自动化操作流程.

![](/assets/picgo/864083dc59cfabf74e859cc1aeb41acd.png)

点击 record 开始记录,结束后再次点击红色按钮即可结束录制过程,可以看到最终生成了很多操作步骤.

![](/assets/picgo/ae6edb704cebbf0853b36107605fa703.png)

点击生成的流程图开始按钮,重放刚刚的录制过程,同时录制的流程也支持自定义修改.

![](/assets/picgo/b0c49fdc7aaf3fc7b634edf958f0369f.png)

### 流程详解

双击流程块即可编辑具体的执行任务块,包括修改参数,添加描述等信息.

**Trigger**

触发器,表示该流程什么时候执行,支持手动运行,定时运行,周期运行等多种方式.

![](/assets/picgo/d2e4405611d02e77682de87c1f282809.png)

这里暂不做任何更改,继续使用手动模式: `Manually`

**连接线**

双击`New tab`新标签页之前注意到流程块之间是有连接线表示方向的,有输入和输出两个方向,删除该任务块时两侧的连接线自动删除,需要手动连接到新的任务块.

![](/assets/picgo/8248485143498bd6a0536412fec02523.png)

点击任务块上方的开始按钮也可以从此开始运行,不包括之前已连接的任务.

![](/assets/picgo/e8412dfa47fc8be7d319db9460536c08.png)

修改后请注意及时保存,同时开发时候建议打开调试功能,蓝色 debugger.

![](/assets/picgo/81071accaa92726499bc8b37817b96fa.png)

下次想要单独测试任务块就可以在任务块的上方开启调试开关,等到运行经过该流程时就能选择暂停或继续.

![](/assets/picgo/91515118a7c72057147cf9525c8feae5.png)

**New tab**

新标签页,在同一个浏览器窗口中打开新的标签页,类似的操作还有打开新窗口.

![](/assets/picgo/1bcb893cc7058180948fd55c33e65792.png)

**Click element**

点击元素,最后测的验证元素选择器是否正确,被选中的元素会出现高亮,也可以重新选择元素.

![](/assets/picgo/d94378c7405827885eb4843f4755d61a.png)

**定位元素**

在浏览器插件右上角选择`automa`后有个元素选择器,可以帮助我们定位到具体的元素.

![](/assets/picgo/edefd28e7b5f2b0001a05d5fc1c48950.png)

现在已经实现打开微信公众号留言模块后台,现在可以定位到文章元素,这一步适合手动定位.

![](/assets/picgo/88c3cb49cf8c72481cd43caf7cc6c08f.png)

**Hover element**

悬停元素,用于鼠标悬停操作,类似于`mouseenter`事件,鼠标经过后才会展示出评论以及点赞的按钮.

![](/assets/picgo/b49ed9237a40bd051048ddbcf571267b.png)

同样地,只需要元素选择器定位即可实现鼠标悬停效果.

![](/assets/picgo/9e301ad89ccc1cf445b24c93d0d1b2ee.png)

接下来的点击元素,输入评论内容,再次点击回复按钮就是简单的重复操作了,省略不写.

![](/assets/picgo/d7c817eaac2d42a7658701d8d926ccc1.gif)

## 总结

本文主要介绍了 automa 开发公众号留言自动回复的入门版,通过录制的方式提供基本的流程,再结合元素定位器对录制的工作流进行自定义编辑,从而实现从 0 到 1 的突破.

当然,更多的细节需要慢慢完善,演示的只是最简单的版本,真正可用版本需要考虑是否已登录微信公众号后台以及是否重复回复以及如何回复等等问题.

```
感兴趣的小伙伴可以在自己试试看,源码已上传网盘,感兴趣自取即可.
我用夸克网盘分享了「公众号自动回复留言.json」，点击链接即可保存。打开「夸克APP」在线查看，支持多种文档格式转换。
链接：https://pan.quark.cn/s/e3401fe07a6f
```

![](/assets/picgo/cd9f7e9d2938f5974adc667be85e1c78.png)

## 往期精彩文章

- [Automa 插件之 js 脚本小技巧：在浏览器环境下轻松判断操作系统](https://mp.weixin.qq.com/s?__biz=MzU3NTc1MDMwOQ==&mid=2247485303&idx=1&sn=c1313f02dd5d5fe026c0df24ea993fc0&chksm=fd1f2ebdca68a7ab1857dada18197666db99d0dc8c2311faa5505fd871da62eb04765629b483&token=1806469695&lang=zh_CN#rd)
- [Automa 插件之 js 脚本小技巧：零依赖的日期时间格式化,亲测好用!](https://mp.weixin.qq.com/s?__biz=MzU3NTc1MDMwOQ==&mid=2247485909&idx=1&sn=a95d0e743c6442762321a810ffed09e5&chksm=fd1f201fca68a9097fb2a1d9d5ae737da415efff5eaa809483555cc1e9afe38503535a07570c&token=966863382&lang=zh_CN#rd)
- [Automa 插件之 js 脚本小技巧：在浏览器环境下轻松判断操作系统](https://mp.weixin.qq.com/s?__biz=MzU3NTc1MDMwOQ==&mid=2247485303&idx=1&sn=c1313f02dd5d5fe026c0df24ea993fc0&chksm=fd1f2ebdca68a7ab1857dada18197666db99d0dc8c2311faa5505fd871da62eb04765629b483&token=966863382&lang=zh_CN#rd)

![](/assets/picgo/31f9180b2c2601eb166e885a92d804e3.jpg)

## 欢迎扫码关注

![微信公众号「雪之梦技术驿站」](/assets/picgo/a92b2e6f79ec25e79869ec6783fba19a.jpg)

> `欢迎扫码关注,私信回复『加群』一起交流技术`

![](/assets/picgo/5b049d5aab84c068fdc306ca90006bf7.jpg)
